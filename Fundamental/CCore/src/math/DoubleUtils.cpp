/* DoubleUtils.cpp */
//----------------------------------------------------------------------------------------
//
//  Project: CCore 4.01
//
//  Tag: Fundamental
//
//  License: Boost Software License - Version 1.0 - August 17th, 2003
//
//            see http://www.boost.org/LICENSE_1_0.txt or the local copy
//
//  Copyright (c) 2022 Sergey Strukov. All rights reserved.
//
//----------------------------------------------------------------------------------------

#if __has_include(<CCore/inc/base/DoubleFormat.h>)

#include <cmath>

#include <CCore/inc/math/DoubleUtils.h>

namespace CCore {

/* struct DoubleTo2Based */

static constexpr int DExp = DoubleFormat::ExpBias+DoubleFormat::FractBits ;

void DoubleTo2Based::correct()
 {
  unsigned delta=UIntFunc<BaseType>::CountZeroLSB(base);

  base>>=delta;
  bin_exp+=delta;
 }

DoubleTo2Based::DoubleTo2Based(double value)
 {
  DoubleFormat obj(value);

  unsigned exp=obj.getExp();

  if( exp==DoubleFormat::MaxExp )
    {
     if( obj.getFract() )
       {
        kind=DoubleIsNan;
       }
     else
       {
        kind=DoubleIsInf;
       }
    }
  else if( exp )
    {
     kind = obj.getSign()? DoubleIsNeg : DoubleIsPos ;

     bin_exp=int(exp)-DExp;
     base=obj.getFract()+(1+DoubleFormat::MaxFract);

     correct();
    }
  else
    {
     base=obj.getFract();

     if( base )
       {
        kind = obj.getSign()? DoubleIsNeg : DoubleIsPos ;

        bin_exp=1-DExp;

        correct();
       }
     else
       {
        kind=DoubleIsNull;
       }
    }
 }

/* struct DoubleTo10Based */

static constexpr int MinBinExp = 1-DExp ;
static constexpr int MaxBinExp = DoubleFormat::MaxExp-1-DoubleFormat::ExpBias ;

static constexpr int MinDecExp = -323 ;
static constexpr int MaxDecExp =  308 ;

static constexpr int MinDigitLen =  6 ;
static constexpr int MaxDigitLen = 16 ;

double DoubleTo10Based::Pow10lo(int dec_exp)
 {
  static const double Table[MaxDecExp-MinDecExp+1]= // [632]
   {
                 0x1P-1073 ,              0x5P-1072 ,             0x65P-1073 ,             0xFDP-1071 ,            0x4F1P-1070 ,          0x18B51P-1073 ,          0xF712BP-1073 ,        0x134D761P-1074 ,
           0xC1069CDP-1074 ,       0x78A42205P-1074 ,      0x25B34AA19P-1073 ,     0x2F201D49FBP-1074 ,    0x1D74124E3D1P-1074 ,   0x12688B70E62BP-1074 ,   0x5C0AB9347ED7P-1073 ,  0x3986B3C0CF469P-1073 ,
    0x11FA182C40C60DP-1072 ,  0x16789E3750F79P-1065 , 0x1C16C5C5253575P-1066 , 0x118E3B9B374169P-1062 , 0x15F1CA820511C3P-1059 ,  0x6DB8F48A1958DP-1054 ,   0x892731AC9FAFP-1047 ,  0x2ADC3F85F1E6BP-1046 ,
    0x1AC9A7B3B7302FP-1046 , 0x10BE08D0527E1DP-1042 ,  0x53B62C119C769P-1037 , 0x1A28EDC580E50DP-1036 ,  0x20B32936E11E5P-1029 ,  0xA37FCE1265979P-1028 , 0x198BF832DFDFAFP-1026 , 0x1FEEF63F97D79BP-1023 ,
    0x13F559E7BEE6C1P-1019 , 0x18F2B061AEA071P-1016 , 0x1F2F5C7A1A488DP-1013 ,  0x26FB3398A0DABP-1006 ,  0xC2E801FB24457P-1005 ,  0xF3A20279ED56DP-1002 ,   0x261150630D159P-996 ,   0xBE5691EF416BDP-995 ,
     0x1DBD86CD6238D9P-993 ,  0x129674405D6387P-989 ,  0x173C115074BC69P-986 ,   0x742C569247AE1P-981 ,   0x91376C36D9999P-978 ,  0x16B0A8E891FFFFP-976 ,  0x1C5CD322B67FFFP-973 ,  0x11BA03F5B20FFFP-969 ,
     0x162884F31E93FFP-966 ,  0x1BB2A62FE638FFP-963 ,  0x114FA7DDEFE39FP-959 ,  0x15A391D56BDC87P-956 ,  0x1B0C764AC6D3A9P-953 ,  0x10E7C9EEBC4449P-949 ,   0x5486F1A9AD557P-944 ,  0x1A6A2B85062AB3P-943 ,
      0x10825B3323DABP-935 ,   0x528BC7FFB3457P-934 ,  0x19CBAE7FE805B3P-933 ,  0x101F4D0FF1038FP-929 ,  0x14272053ED4473P-926 ,   0x1930E868E8959P-919 ,  0x1F7D228322BAF5P-920 ,  0x13AE3591F5B4D9P-916 ,
     0x1899C2F673220FP-913 ,  0x1EC033B40FEA93P-910 ,   0x4CE0814227CA7P-904 ,  0x18062864AC6F43P-903 ,  0x1E07B27DD78B13P-900 ,   0x4B133E3A9ADBBP-894 ,  0x177603725064A7P-893 ,  0x1D53844EE47DD1P-890 ,
      0x92A1958A76751P-885 ,  0x16E93F5DA2824BP-883 ,   0xE51C79A85916FP-879 ,  0x11E6398126F5CBP-876 ,  0x165FC7E170B33DP-873 ,  0x1BF7B9D9CCE00DP-870 ,   0x22F5A85040181P-863 ,   0xAECC499140785P-862 ,
     0x1B4FEB7EB212CDP-860 ,    0x4447CCBCBD2FP-850 ,   0x15566FFAFB1EBP-849 ,   0x6AB02FE6E7997P-848 ,  0x10AB877C142FF9P-846 ,   0x29ACD2B63277FP-840 ,   0xD0601D8EFC57BP-839 ,  0x1047824F2BB6D9P-836 ,
      0x145962E2F6A49P-829 ,   0x65BEEE6ED136DP-828 ,  0x1FCBAA82A16121P-827 ,   0x4F7D2A469372DP-821 ,   0xC6B8E9B0709F1P-819 ,   0xF867241C8CC6DP-816 ,   0x26D01DA475FF1P-810 ,   0xC21094364DFB5P-809 ,
     0x1E5297287C2F45P-807 ,  0x12F39E794D9D8BP-803 ,   0xBD8430BD08277P-799 ,  0x1D9CA79D894629P-797 ,   0x940F4613AE5EDP-792 ,   0x172262F3133EDP-786 ,   0x73ABEEBF603A1P-785 ,  0x1212DD4DE70913P-783 ,
     0x169794A160CB57P-780 ,  0x1C3D79C9B8FE2DP-777 ,   0x4699B0784E7B7P-771 ,  0x16100725988693P-770 ,   0x372811DDFD507P-764 ,  0x113C85955F2923P-763 ,   0x562E9BEADBCDBP-758 ,  0x1AEE90B964B047P-757 ,
      0x435469CF7BB8BP-751 ,  0x150A6110D6A9B7P-750 ,  0x1A4CF9550C5425P-747 ,  0x10701BD527B497P-743 ,  0x148C22CA71A1BDP-740 ,   0x66BCADF43828BP-735 ,  0x100D7B2E28C65BP-733 ,   0xA086CFCD97BF9P-729 ,
     0x191510781FB5EFP-727 ,  0x1F5A549627A36BP-724 ,  0x139874DDD8C623P-720 ,   0x61FA48553BDEBP-715 ,  0x1E9E369AA2B597P-714 ,   0x991711052D8BFP-709 ,   0xBF5CD54678EEFP-706 ,  0x1DE6815302E555P-704 ,
     0x12B010D3E1CF55P-700 ,   0xBAE0A846D2195P-696 ,  0x1D331A4B10D3F5P-694 ,  0x123FF06EEA8479P-690 ,  0x16CFEC8AA52597P-687 ,  0x1C83E7AD4E6EFDP-684 ,   0x8E938662882AFP-679 ,   0xB23867FB2A35BP-676 ,
     0x1BD8D03F3E9863P-674 ,   0x8B3C113C38F9FP-669 ,   0xAE0B158B47387P-666 ,  0x1B31BB5DC320D1P-664 ,   0x87F8A8D4CFA41P-659 ,  0x153EDA614071A3P-657 ,   0x6A3A43E642383P-652 ,  0x10991A9BFA58C7P-650 ,
     0x14BF6142F8EEF9P-647 ,   0x33DE73276E557P-641 ,  0x103583FC527AB3P-640 ,    0xA21727DB38CBP-632 ,   0x32A73C7481BF7P-631 ,   0xFD442E4688BD3P-630 ,  0x13C9539D82AEC7P-627 ,  0x18BBA884E35A79P-624 ,
      0x3DD5254C38623P-618 ,  0x13529BA7D19EAFP-617 ,   0xC13A148E3032DP-613 ,  0x1E3113363787F1P-611 ,   0x96F5600F15A7BP-606 ,   0x5E595C096D88DP-602 ,  0x1D7BECC2F23AC1P-601 ,  0x126D73F9D764B9P-597 ,
     0x1708D0F84D3DE7P-594 ,  0x1CCB0536608D61P-591 ,   0x47FB8D07F1617P-585 ,   0x59FA7049EDB9DP-582 ,  0x1C1E43171A4A11P-581 ,   0x8C974F7383725P-576 ,  0x15F7A46A0C89DDP-574 ,   0x6DD636123EB15P-569 ,
      0x44A5E1CB672EDP-565 ,   0xAB9EB47C81F51P-563 ,   0xD686619BA2725P-560 ,   0x8613FD0145877P-556 ,   0xA798FC4196E95P-553 ,   0x68BF9DA8FE51DP-549 ,  0x105DF0A267BCC9P-547 ,  0x14756CCB01ABFBP-544 ,
      0xCC963FEE10B7DP-540 ,   0x3FEEF3FA65397P-535 ,  0x13FAAC3E3FA1F3P-534 ,   0x18F9574DCF8A7P-527 ,   0x7CDEB4850DB43P-526 ,  0x1382CC34CA2427P-524 ,  0x18637F41FCAD31P-521 ,   0xF3E2F893DEC3FP-517 ,
      0x986DDB5C6B3A7P-513 ,   0xBE89523386091P-510 ,  0x1DC574D80CF16BP-508 ,   0x94DB483840B71P-503 ,  0x17424348CA1C9BP-501 ,   0xE896A0D7E51E1P-497 ,  0x122BC490DDE659P-494 ,   0x16B6B5B5155FFP-487 ,
      0x71918C896ADFBP-486 ,  0x11BEBDF578B2F3P-484 ,   0x162E6D72D6DFBP-477 ,   0x6EE8233E325E7P-476 ,  0x11544581B7DEC1P-474 ,   0xAD4AB7112EB39P-470 ,   0xD89D64D57A607P-467 ,  0x10EC4BE0AD8F89P-464 ,
     0x15275ED8D8F36BP-461 ,   0xD389B47879823P-457 ,   0x421B0865A5F8BP-452 ,  0x14A8729FC3DDB7P-451 ,   0x674A3D1ED3549P-446 ,  0x1023998CD10537P-444 ,   0x50B1FFC0151A1P-439 ,   0xC9BCFF6034C13P-437 ,
     0x1F8587E7083E2FP-435 ,  0x13B374F06526DDP-431 ,  0x18A0522C7E7095P-428 ,   0xF64335BCF065DP-424 ,   0x4CF500CB0B1FDP-419 ,  0x180C903F7379F1P-418 ,   0xF07DA27A82C37P-414 ,   0x4B2742C648DD1P-409 ,
     0x177C44DDF6C515P-408 ,  0x1D5B561574765BP-405 ,  0x125915CD68C9F9P-401 ,  0x16EF5B40C2FC77P-398 ,  0x1CAB3210F3BB95P-395 ,  0x11EAFF4A98553DP-391 ,   0x5996FC74F9AA3P-386 ,  0x1BFF2EE48E052FP-385 ,
     0x117F7D4ED8C33DP-381 ,  0x15DF5CA28EF40DP-378 ,   0x1B5733CB32B11P-371 ,   0x88B402F7FD755P-370 ,  0x155C2076BF9A55P-368 ,   0xD59944A37C075P-364 ,   0x857FCAE62D849P-360 ,  0x14DBF7B3F71CB7P-358 ,
      0x684BD683D38F9P-353 ,  0x104BD984990E6FP-351 ,   0xA2F67F2DFA905P-347 ,  0x197683DF2F268DP-345 ,   0x1FD424D6FAF03P-338 ,   0x9F24B832E6B0FP-337 ,   0xC6EDE63FA05D3P-334 ,  0x1F152BF9F10E8FP-332 ,
     0x136D3B7C36A919P-328 ,    0xC24452DA229BP-320 ,   0x3CB559E42AD07P-319 ,  0x12F8AC174D6123P-318 ,   0x5EDB5C7482E5BP-313 ,  0x1DA48CE468E7C7P-312 ,   0x4A1B603B06437P-306 ,  0x17288E1271F513P-305 ,
      0x39E5632E1CE4BP-299 ,  0x1217AEFE690777P-298 ,  0x169D9ABE034955P-295 ,   0xE2280B6C20DD5P-291 ,   0x8D590723948A5P-287 ,  0x1615E91D8F359DP-285 ,   0x6E6D8D93CC0C1P-280 ,   0x8A08F0F8BF0F1P-277 ,
     0x159165A6DDDA5BP-275 ,   0xD7ADF884AA879P-271 ,  0x10D9976A5D5297P-268 ,  0x150FFD44F4A73DP-265 ,   0x694FF258C7443P-260 ,  0x10747DDDDF22A7P-258 ,  0x14919D5556EB51P-255 ,   0xCDB0255565313P-251 ,
     0x1011C2EAABE7D7P-248 ,  0x141633A556E1CDP-245 ,  0x191BC08EAC9A41P-242 ,  0x1F62B0B257C0D1P-239 ,  0x139DAE6F76D883P-235 ,  0x18851A0B548EA3P-232 ,   0x7A998238A6C93P-227 ,  0x1327FC58DA0F6FP-225 ,
     0x17F1FB6F10934BP-222 ,   0xEF73D256A5C0FP-218 ,  0x12B50C6EC4F313P-215 ,   0x2EC49F14EC5FBP-209 ,   0xE9D71B689DDE7P-208 ,    0x9226712162ABP-200 ,  0x16D601AD376AB9P-202 ,  0x1C8B8218854567P-199 ,
       0x8EB98A7A9A5BP-190 ,   0x2C99FB46503C7P-189 ,   0xDF01E85F912E3P-188 ,   0x45B0989DDD5E7P-183 ,  0x15C72FB1552D83P-182 ,   0x6CE3EE76A9E39P-177 ,   0x881CEA14545C7P-174 ,   0xAA24249969739P-171 ,
      0xD4AD2DBFC3D07P-168 ,  0x109D8792FB4C49P-165 ,  0x14C4E977BA1F5BP-162 ,   0xCFB11EAD45399P-158 ,  0x1039D66589687FP-155 ,  0x14484BFEEBC29FP-152 ,  0x195A5EFEA6B347P-149 ,  0x1FB0F6BE506019P-146 ,
     0x13CE9A36F23C0FP-142 ,  0x18C240C4AECB13P-139 ,   0x3DE5A1EBB4FBBP-133 ,  0x1357C299A88EA7P-132 ,  0x182DB34012B251P-129 ,  0x1E392010175EE5P-126 ,  0x12E3B40A0E9B4FP-122 ,  0x179CA10C924223P-119 ,
      0x760F253EDB4ABP-114 ,  0x12725DD1D243ABP-112 ,   0xB877AA3236A4BP-108 ,   0x734ACA5F6226FP-104 ,  0x1203AF9EE75615P-102 ,   0x16849B86A12B9BP-99 ,   0x1C25C268497681P-96 ,   0x119799812DEA11P-92 ,
      0x15FD7FE1796495P-89 ,    0xDBE6FECEBDEDDP-85 ,    0x44B82FA09B5A5P-80 ,   0x15798EE2308C39P-79 ,    0x35AFE535795E9P-73 ,   0x10C6F7A0B5ED8DP-72 ,    0x14F8B588E368FP-65 ,    0x68DB8BAC710CBP-64 ,
      0x10624DD2F1A9FBP-62 ,    0xA3D70A3D70A3DP-58 ,   0x19999999999999P-56 ,                  0x1P0 ,                  0x5P1 ,                 0x19P2 ,                 0x7DP3 ,                0x271P4 ,
                   0xC35P5 ,               0x3D09P6 ,              0x1312DP7 ,              0x5F5E1P8 ,             0x1DCD65P9 ,            0x9502F9P10 ,           0x2E90EDDP11 ,           0xE8D4A51P12 ,
             0x48C27395P13 ,         0x16BCC41E9P14 ,         0x71AFD498DP15 ,        0x2386F26FC1P16 ,        0xB1A2BC2EC5P17 ,       0x3782DACE9D9P18 ,      0x1158E460913DP19 ,      0x56BC75E2D631P20 ,
        0x1B1AE4D6E2EF5P21 ,     0x878678326EAC9P22 ,     0xA968163F0A57BP25 ,     0x69E10DE76676DP29 ,     0x108B2A2C28029P35 ,     0x52B7D2DCC80CDP36 ,    0x19D971E4FE8401P37 ,    0x1027E72F1F1281P41 ,
       0x1431E0FAE6D721P44 ,    0x193E5939A08CE9P47 ,     0x7E37BE2022C09P52 ,     0x9DC5ADA82B70BP55 ,     0x629B8C891B267P59 ,    0x1ED09BEAD87C03P60 ,     0x9A130B963A6C1P65 ,     0xC097CE7BC9071P68 ,
       0x1E17B84357691BP70 ,    0x12CED32A16A1B1P74 ,    0x178287F49C4A1DP77 ,     0x758CA7C70D729P82 ,     0x92EFD1B8D0CF3P85 ,      0xB7ABC6270503P92 ,     0x3965ADEC3190FP93 ,    0x11EFC659CF7D4BP94 ,
        0xB35DBF821AE4FP98 ,    0xE0352F62A19E3P101 ,   0x118427B3B4A05BP104 ,    0xAF298D050E439P108 ,   0x1B5E7E08CA3A8FP110 ,   0x111B0EC57E6499P114 ,     0x558749DB77F7P123 ,    0x1ABA4714957D3P124 ,
       0x85A36366EB71FP125 ,   0x14E1878814C9CDP127 ,     0x6867A5A867F1P136 ,    0x20A063C4A07B5P137 ,    0xA321F2D722689P138 ,   0x197D4DF19D6057P140 ,   0x1FDCA16E04B86DP143 ,    0x4FA793930BCD1P149 ,
      0x18E45E1DF3B015P150 ,    0xF8EBAD2B84E0DP154 ,    0x1372698766619P161 ,    0x613C0FA4FFE7DP162 ,    0xF316271C7FC39P164 ,   0x12FDBB0E39FB47P167 ,   0x17BD29D1C87A19P170 ,   0x1DAC74463A989FP173 ,
      0x128BC8ABE49F63P177 ,    0x5CBAEB5B771CFP182 ,   0x1CFA698C95390BP183 ,   0x121C81F7DD43A7P187 ,   0x16A3A275D49491P190 ,   0x1C4C8B1349B9B5P193 ,   0x11AFD6EC0E1411P197 ,   0x161BCCA7119915P200 ,
      0x1BA2BFD0D5FF5BP203 ,    0x228B6FC50B7F3P210 ,   0x159725DB272F7FP210 ,    0xD7E77A8F87DAFP214 ,   0x10DE1593369D1BP217 ,    0xA8ACD7C022231P221 ,    0xD2D80DB02AABDP224 ,    0x41E384470D55BP229 ,
      0x14971956342AC7P230 ,   0x19BCDFABC13579P233 ,    0x40582F2D6305BP239 ,   0x141B8EBE2EF1C7P240 ,   0x1922726DBAAE39P243 ,   0x1F6B0F092959C7P246 ,    0x4E8BA596E7607P252 ,   0x188BA3BF284E23P253 ,
       0x7ABA32BBC986BP258 ,   0x132D17ED577D0BP260 ,    0xBFC2EF456AE27P264 ,    0xEFB3AB16C59B1P267 ,   0x12BA095DC7701DP270 ,   0x17688BB5394C25P273 ,    0xEA1575143CF97P277 ,    0x4926B496530DFP282 ,
       0x5B7061BBE7D17P285 ,   0x1C931E8AB87173P286 ,   0x11DBF316B346E7P290 ,   0x1652EFDC6018A1P293 ,    0xDF3D5E9BC0F65P297 ,    0x8B865B215899FP301 ,    0xAE67F1E9AEC07P304 ,   0x1B403DCC834E11P306 ,
      0x1108269FD210CBP310 ,   0x154A3047C694FDP313 ,   0x1A9CBC59B83A3DP316 ,    0x850FADC099233P321 ,   0x14CA732617ED7FP323 ,   0x19FD0FEF9DE8DFP326 ,   0x103E29F5C2B18BP330 ,    0xA26DA3999AEF7P334 ,
       0xCB090C8001AB5P337 ,   0x1FB969F40042C5P339 ,   0x13D3E2388029BBP343 ,    0xC646D63501A15P347 ,    0x7BEC45E12104DP351 ,     0x4D73ABACB4A3P359 ,   0x183425A5F872F1P356 ,   0x1E412F0F768FADP359 ,
       0x4BA2F5A6A8673P365 ,   0x17A2ECC414A03FP366 ,   0x1D8BA7F519C84FP369 ,   0x127748F9301D31P373 ,    0xB8A8D9BBE123FP377 ,   0x1CDA62055B2D9DP379 ,    0x9043EA1AC7E41P384 ,   0x168A9C942F3BA3P386 ,
      0x1C2D43B93B0A8BP389 ,   0x119C4A53C4E697P393 ,   0x16035CE8B6203DP396 ,    0x6E10D08B8EA13P401 ,   0x1132A095CE492FP403 ,   0x157F48BB41DB7BP406 ,    0xD6F8D7509292DP410 ,    0x2196E1A496E6FP416 ,
       0xA7F26836F282BP417 ,    0x68F781225791BP421 ,   0x1066AC2D5DAEC3P423 ,    0x52015CE2D469DP428 ,    0xCD03683713089P430 ,   0x100444244D7CABP433 ,    0xA02AA96B06DEBP437 ,   0x1906AA78B912CBP439 ,
       0xFA42A8B73ABBFP443 ,   0x138D352E5096AFP446 ,    0xC38413CF25E2DP450 ,   0x1E8CA3185DEB71P452 ,   0x1317E5EF3AB327P456 ,    0x17DDDF6B095FFP463 ,    0x77555D172EDFBP464 ,    0x4A955A2E7D4BDP468 ,
      0x174EAC2E8727B1P469 ,   0x1D22573A28F19DP472 ,    0x91ABB422CCB81P477 ,    0xB616A12B7FE61P480 ,   0x1C73892ECBFBF3P482 ,    0x23906B7A7EFAFP489 ,    0xB1D219647AE6BP490 ,   0x1BC8D3F7B3340BP492 ,
      0x115D847AD00087P496 ,   0x15B4E5998400A9P499 ,   0x1B221EFFE500D3P502 ,    0x43D54D7FBC821P508 ,   0x1532A837EAE8A5P509 ,    0xD3FA922F2D167P513 ,   0x108F936BAF85C1P516 ,   0x14B378469B6731P519 ,
      0x19E056584240FDP522 ,    0x8161AFB94B44FP527 ,    0xA1BA1BA79E163P530 ,   0x1945145230B377P532 ,   0x1F965966BCE055P535 ,   0x13BDF7E0360C35P539 ,   0x18AD75D8438F43P542 ,   0x1ED8D34E547313P545 ,
       0x4D1E1043D31FBP551 ,   0x1819651531F9E7P552 ,   0x1E1FBE5A7E7861P555 ,    0x4B4F5BE23C2CFP561 ,    0x5E2332DACB383P564 ,   0x1D6AFFE45F818FP565 ,   0x1262DFEEBBB0F9P569 ,   0x16FB97EA6A9D37P572 ,
      0x1CBA7DE5054485P575 ,   0x11F48EAF234AD3P579 ,    0x2CE364B5D83B1P585 ,    0xE070F78D39275P586 ,    0x8C469AB843B89P590 ,   0x15EB082CCA94D7P592 ,   0x1B65CA37FD3A0DP595 ,    0x223F3CC5FC889P602 ,
       0xAB3C2FDDEEAADP603 ,    0x1AC1677AAD4ABP609 ,    0x85C7056562757P610 ,    0xA738C6BEBB12DP613 ,    0x1A20DF0DCD3AFP619 ,    0x82A45B450226BP620 ,    0x51A6B90B21583P624 ,   0x198419D37A6B8FP625 ,
       0xFF290242C8339P629 ,   0x13EF342D37A407P632 ,   0x18EB0138858D09P635 ,    0x7C97061A9BC13P640 ,   0x137798F428562FP642 ,   0x18557F31326BBBP645 ,    0xF356F7EBF8355P649 ,    0x98165AF37B215P653 ,
      0x17C37E360B3D35P655 ,    0xEDA2EE1C70641P659 ,   0x1290BA9A38C7D1P662 ,   0x1734E940C6F9C5P665 ,   0x1D022390F8B837P668 ,    0x910AB1D4DB991P673 ,   0x16A9ABC9424FEBP675 ,    0xE2A0B5DC971F3P679 ,
      0x11B48E353BCE6FP682 ,   0x1621B1C28AC20BP685 ,    0xDD50F1996B947P689 ,   0x114A52DFFC6799P692 ,   0x159CE797FB817FP695 ,   0x1B04217DFA61DFP698 ,   0x10E294EEBC7D2BP702 ,    0xA8D9D1535CE3BP706 ,
       0x698822D41A0E5P710 ,    0x41F515C49048FP714 ,   0x149C96CD6D16CBP715 ,    0xCE1DE40642E3FP719 ,   0x101A55D07D39CFP722 ,    0xA1075A24E4421P726 ,   0x19292615C3AA53P728 ,    0x3EE6DF366929DP734 ,
      0x13A825C100DD11P735 ,   0x18922F31411455P738 ,   0x1EB6BAFD91596BP741 ,    0x9991A6F3D6BF1P746 ,   0x17FEC216198DDBP748 ,    0xEFF394DCFF8A9P752 ,   0x12BF07A143F6D3P755 ,    0x2EDD931329E91P761 ,
       0xEA53DF5FD18D5P762 ,    0x92746B9BE2F85P766 ,   0x16E230D05B76CDP768 ,     0x39357A08E4A9P778 ,    0x11E0B622C774DP779 ,    0x59638EADE5481P780 ,   0x1BEF1C9657A685P781 ,   0x117571DDF6C813P785 ,
       0x2BA59CAAE8F43P791 ,    0xDA3C0F568CC4FP792 ,   0x110CB132C2FF63P795 ,   0x154FDD7F73BF3BP798 ,    0xD51EA6FA85785P802 ,    0x8533285C936B3P806 ,     0x533FF939DC23P814 ,    0x1A03FDE214CAFP815 ,
       0x8213F56A67F6BP816 ,   0x14531E58A03E8BP818 ,    0xCB3F2F7642717P822 ,    0xFE0EFB53D30DDP825 ,    0x4F64AE8A31F45P830 ,   0x18CF768B2F9C59P831 ,    0x1F03542DFB837P838 ,    0x9B10A4E5E9913P839 ,
      0x183A99C3EC7EAFP841 ,   0x1E494034E79E5BP844 ,   0x12EDC82110C2F9P848 ,   0x17A93A2954F3B7P851 ,   0x1D9388B3AA30A5P854 ,   0x127C35704A5E67P858 ,   0x171B42CC5CF601P861 ,   0x1CE2137F743381P864 ,
       0x120D4C2FA8A03P872 ,   0x16909F3B92C83DP871 ,    0x70D31C29DDE93P876 ,   0x11A0FC668AAC6FP878 ,   0x16093B802D578BP881 ,    0xDC5C5301C56B7P885 ,   0x1137367C236C65P888 ,    0xAC2820D9623BFP892 ,
       0xD732290FBACAFP895 ,    0x867F59A9D4BEDP899 ,   0x1503E602893DD1P901 ,   0x1A44DF832B8D45P904 ,   0x106B0BB1FB384BP908 ,    0xA42E74F3D032FP912 ,    0xCD3A1230C43FBP915 ,   0x1008896BCF54F9P918 ,
       0x2815578D86547P924 ,    0xC86AB5C39FA63P925 ,    0x3EA158CD21E3FP930 ,   0x13926BC01A973BP931 ,   0x187706B0213D09P934 ,    0x7A532170A6313P939 ,   0x131CFD3999F7AFP941 ,   0x17E43C8800759BP944 ,
       0xEEEA5D5004981P948 ,   0x12AA4F4A405BE1P951 ,   0x1754E31CD072D9P954 ,    0x1D2A1BE4048F9P961 ,    0x91D28B7416CDDP962 ,    0x2D91CB9447205P967 ,   0x1C7B1F3CAC7433P967 ,   0x11CCF385EBC89FP971
   };

  return Table[dec_exp-MinDecExp];
 }

double DoubleTo10Based::Pow10hi(int dec_exp)
 {
  static const double Table[MaxDecExp-MinDecExp+1]= // [632]
   {
                 0x3P-1074 ,             0x15P-1074 ,             0xCBP-1074 ,            0x7E9P-1074 ,           0x4F11P-1074 ,          0x316A3P-1074 ,         0x1EE257P-1074 ,         0x9A6BB1P-1073 ,
           0x60834E7P-1073 ,       0x3C521103P-1073 ,      0x4B6695433P-1074 ,      0xBC807527FP-1072 ,     0xEBA09271E9P-1073 ,    0x49A22DC398BP-1072 ,   0xB8157268FDAFP-1074 ,  0x730D67819E8D3P-1074 ,
     0x8FD0C16206307P-1071 , 0x16789E3750F791P-1069 ,  0xE0B62E2929ABBP-1065 ,  0x8C71DCD9BA0B5P-1061 ,  0x57C72A0814471P-1057 , 0x1B6E3D22865635P-1056 , 0x1124E63593F5E1P-1052 , 0x156E1FC2F8F359P-1049 ,
     0x1AC9A7B3B7303P-1042 ,  0x85F0468293F0FP-1041 , 0x14ED8B04671DA5P-1039 ,  0xD1476E2C07287P-1035 , 0x1059949B708F29P-1032 , 0x146FF9C24CB2F3P-1029 ,  0x198BF832DFDFBP-1022 ,  0x7FBBD8FE5F5E7P-1021 ,
     0x9FAACF3DF7361P-1018 ,  0xC795830D75039P-1015 ,  0xF97AE3D0D2447P-1012 , 0x137D99CC506D59P-1009 , 0x185D003F6488AFP-1006 , 0x1E74404F3DAADBP-1003 ,  0x1308A831868AC9P-999 ,  0x17CAD23DE82D7BP-996 ,
      0xEDEC366B11C6DP-992 ,   0x252CE880BAC71P-986 ,   0xB9E08A83A5E35P-985 ,  0x1D0B15A491EB85P-983 ,  0x1226ED86DB3333P-979 ,       0xB58547449P-959 ,      0x38B9A6456DP-958 ,     0x11BA03F5B21P-957 ,
        0x58A213CC7A5P-956 ,    0x1BB2A62FE639P-955 ,    0x8A7D3EEF7F1DP-954 ,   0x2B4723AAD7B91P-953 ,   0xD863B256369D5P-952 ,   0x873E4F75E2225P-948 ,  0x1521BC6A6B555DP-946 ,   0x69A8AE1418AADP-941 ,
     0x10825B3323DAB1P-939 ,  0x14A2F1FFECD15DP-936 ,   0x672EB9FFA016DP-931 ,   0x101F4D0FF1039P-925 ,   0x509C814FB511DP-924 ,  0x1930E868E89591P-923 ,   0xFBE9141915D7BP-919 ,   0x9D71AC8FADA6DP-915 ,
      0x1899C2F673221P-909 ,   0x7B00CED03FAA5P-908 ,  0x1338205089F29DP-906 ,   0x6018A192B1BD1P-901 ,   0x781EC9F75E2C5P-898 ,  0x12C4CF8EA6B6EDP-896 ,   0x2EEC06E4A0C95P-890 ,   0xEA9C227723EE9P-889 ,
     0x125432B14ECEA3P-886 ,   0x5BA4FD768A093P-881 ,  0x1CA38F350B22DFP-880 ,   0x4798E6049BD73P-874 ,   0xB2FE3F0B8599FP-872 ,   0xDFBDCECE67007P-869 ,  0x117AD428200C09P-866 ,  0x15D98932280F0BP-863 ,
      0xDA7F5BF590967P-859 ,  0x1111F32F2F4BC1P-856 ,  0x15566FFAFB1EB1P-853 ,  0x1AAC0BF9B9E65DP-850 ,   0x855C3BE0A17FDP-845 ,  0x14D6695B193BF9P-843 ,  0x1A0C03B1DF8AF7P-840 ,   0x823C12795DB6DP-835 ,
     0x145962E2F6A491P-833 ,  0x196FBB9BB44DB5P-830 ,   0xFE5D54150B091P-826 ,  0x13DF4A91A4DCB5P-823 ,  0x18D71D360E13E3P-820 ,  0x1F0CE4839198DBP-817 ,  0x13680ED23AFF89P-813 ,  0x18421286C9BF6BP-810 ,
      0xF294B943E17A3P-806 ,   0x4BCE79E536763P-801 ,  0x17B08617A104EFP-800 ,   0xECE53CEC4A315P-796 ,  0x1281E8C275CBDBP-793 ,  0x172262F3133ED1P-790 ,  0x1CEAFBAFD80E85P-787 ,   0x484B75379C245P-781 ,
      0x2D2F2942C196BP-777 ,   0xE1EBCE4DC7F17P-776 ,  0x11A66C1E139EDDP-773 ,   0x58401C96621A5P-768 ,  0x1B9408EEFEA839P-767 ,   0x44F216557CA49P-761 ,  0x158BA6FAB6F36DP-760 ,   0x35DD2172C9609P-754 ,
     0x10D51A73DEEE2DP-753 ,   0x2A14C221AD537P-747 ,   0xD267CAA862A13P-746 ,   0x20E037AA4F693P-740 ,   0xA46116538D0DFP-739 ,  0x19AF2B7D0E0A2DP-737 ,   0x4035ECB8A3197P-731 ,  0x1410D9F9B2F7F3P-730 ,
      0x191510781FB5FP-723 ,   0x7D6952589E8DBP-722 ,   0x4E61D37763189P-718 ,  0x187E92154EF7ADP-717 ,   0x3D3C6D35456B3P-711 ,  0x1322E220A5B17FP-710 ,  0x17EB9AA8CF1DDFP-707 ,   0xEF340A98172ABP-703 ,
      0x9580869F0E7ABP-699 ,  0x175C1508DA432BP-697 ,   0xE998D258869FBP-693 ,   0x91FF83775423DP-689 ,   0x2D9FD9154A4B3P-684 ,   0xE41F3D6A7377FP-683 ,  0x11D270CC51055FP-680 ,  0x16470CFF6546B7P-677 ,
      0x6F6340FCFA619P-672 ,  0x11678227871F3FP-670 ,  0x15C162B168E70FP-667 ,   0xD98DDAEE19069P-663 ,  0x10FF151A99F483P-660 ,   0x54FB698501C69P-655 ,  0x1A8E90F9908E0DP-654 ,   0x21323537F4B19P-647 ,
      0xA5FB0A17C777DP-646 ,  0x19EF3993B72AB9P-644 ,   0x40D60FF149EADP-638 ,  0x1442E4FB671961P-637 ,  0x19539E3A40DFB9P-634 ,  0x1FA885C8D117A7P-631 ,   0x2792A73B055D9P-624 ,   0xC5DD44271AD3DP-623 ,
     0x1EEA92A61C3119P-621 ,   0x13529BA7D19EBP-613 ,  0x18274291C6065BP-614 ,   0xF18899B1BC3F9P-610 ,  0x12DEAC01E2B4F7P-607 ,  0x179657025B6235P-604 ,   0xEBDF661791D61P-600 ,   0x936B9FCEBB25DP-596 ,
      0x2E11A1F09A7BDP-591 ,   0xE65829B3046B1P-590 ,  0x11FEE341FC585DP-587 ,  0x167E9C127B6E75P-584 ,   0xE0F218B8D2509P-580 ,  0x1192E9EE706E4BP-577 ,   0xAFBD2350644EFP-573 ,  0x1B758D848FAC55P-571 ,
     0x11297872D9CBB5P-567 ,  0x1573D68F903EA3P-564 ,  0x1AD0CC33744E4BP-561 ,  0x10C27FA028B0EFP-557 ,  0x14F31F8832DD2BP-554 ,  0x1A2FE76A3F9475P-551 ,   0x82EF85133DE65P-546 ,   0x51D5B32C06AFFP-542 ,
     0x1992C7FDC216FBP-541 ,  0x1FF779FD329CB9P-538 ,   0x4FEAB0F8FE87DP-532 ,  0x18F9574DCF8A71P-531 ,  0x1F37AD21436D0DP-528 ,   0x2705986994485P-521 ,   0xC31BFA0FE5699P-520 ,  0x1E7C5F127BD87FP-518 ,
     0x130DBB6B8D674FP-514 ,  0x17D12A4670C123P-511 ,   0x7715D36033C5BP-506 ,  0x129B69070816E3P-504 ,   0x5D090D2328727P-499 ,  0x1D12D41AFCA3C3P-498 ,   0x915E2486EF32DP-493 ,  0x16B6B5B5155FF1P-491 ,
     0x1C6463225AB7EDP-488 ,   0x46FAF7D5E2CBDP-482 ,  0x162E6D72D6DFB1P-481 ,  0x1BBA08CF8C979DP-478 ,   0x8AA22C0DBEF61P-473 ,  0x15A956E225D673P-471 ,  0x1B13AC9AAF4C0FP-468 ,   0x87625F056C7C5P-463 ,
      0x549D7B6363CDBP-459 ,  0x1A71368F0F3047P-458 ,  0x1086C219697E2DP-454 ,   0x2950E53F87BB7P-448 ,  0x19D28F47B4D525P-448 ,   0x20473319A20A7P-441 ,  0x142C7FF0054685P-441 ,  0x19379FEC069827P-438 ,
      0x1F8587E7083E3P-431 ,   0x9D9BA7832936FP-430 ,   0xC5029163F384BP-427 ,  0x1EC866B79E0CBBP-425 ,  0x133D4032C2C7F5P-421 ,   0xC06481FB9BCF9P-417 ,  0x1E0FB44F50586FP-415 ,  0x12C9D0B1923745P-411 ,
      0xBBE226EFB628BP-407 ,   0x756D5855D1D97P-403 ,   0x92C8AE6B464FDP-400 ,   0x2DDEB68185F8FP-395 ,   0xE55990879DDCBP-394 ,   0x8F57FA54C2A9FP-390 ,  0x1665BF1D3E6A8DP-388 ,   0x1BFF2EE48E053P-381 ,
      0x8BFBEA76C619FP-380 ,   0xAEFAE51477A07P-377 ,  0x1B5733CB32B111P-375 ,  0x1116805EFFAEABP-371 ,   0xAAE103B5FCD2BP-367 ,  0x1AB328946F80EBP-365 ,  0x10AFF95CC5B093P-361 ,   0x29B7EF67EE397P-355 ,
     0x1A12F5A0F4E3E5P-355 ,   0x104BD984990E7P-347 ,  0x145ECFE5BF520BP-348 ,   0xCBB41EF979347P-344 ,  0x1FD424D6FAF031P-342 ,  0x13E497065CD61FP-338 ,  0x18DDBCC7F40BA7P-335 ,   0x1F152BF9F10E9P-328 ,
      0x9B69DBE1B548DP-327 ,  0x18488A5B445361P-325 ,  0x1E5AACF2156839P-322 ,   0x4BE2B05D35849P-316 ,  0x17B6D71D20B96DP-315 ,   0x3B4919C8D1CF9P-309 ,  0x1286D80EC190DDP-308 ,   0x5CA23849C7D45P-303 ,
     0x1CF2B1970E7259P-302 ,   0x242F5DFCD20EFP-295 ,   0xB4ECD5F01A4ABP-294 ,  0x1C45016D841BABP-292 ,  0x11AB20E472914BP-288 ,   0xB0AF48EC79ACFP-284 ,  0x1B9B6364F30305P-282 ,  0x11411E1F17E1E3P-278 ,
      0x5645969B77697P-273 ,  0x1AF5BF109550F3P-272 ,   0x21B32ED4BAA53P-265 ,   0xA87FEA27A539FP-264 ,  0x1A53FC9631D10DP-262 ,   0x20E8FBBBBE455P-255 ,   0xA48CEAAAB75A9P-254 ,  0x19B604AAACA627P-252 ,
      0x202385D557CFBP-245 ,   0xA0B19D2AB70E7P-244 ,   0xC8DE047564D21P-241 ,   0xFB158592BE069P-238 ,   0x4E76B9BDDB621P-233 ,   0x6214682D523A9P-230 ,  0x1EA6608E29B24DP-229 ,   0x1327FC58DA0F7P-221 ,
      0x5FC7EDBC424D3P-220 ,  0x1DEE7A4AD4B81FP-219 ,   0x4AD431BB13CC5P-213 ,  0x17624F8A762FD9P-212 ,  0x1D3AE36D13BBCFP-209 ,  0x1244CE242C5561P-205 ,   0xB6B00D69BB55DP-201 ,   0x391704310A8ADP-196 ,
     0x11D7314F534B61P-195 ,  0x164CFDA3281E39P-192 ,  0x1BE03D0BF225C7P-189 ,  0x116C262777579DP-185 ,   0x571CBEC554B61P-180 ,  0x1B38FB9DAA78E5P-179 ,  0x11039D428A8B8FP-175 ,  0x154484932D2E73P-172 ,
     0x1A95A5B7F87A0FP-169 ,   0x84EC3C97DA625P-164 ,   0x5313A5DEE87D7P-160 ,  0x19F623D5A8A733P-159 ,    0x2073ACCB12D1P-148 ,    0xA2425FF75E15P-147 ,   0x32B4BDFD4D669P-146 ,   0xFD87B5F28300DP-145 ,
      0x13CE9A36F23C1P-138 ,   0x63090312BB2C5P-137 ,  0x1EF2D0F5DA7DD9P-136 ,   0x26AF8533511D5P-129 ,   0xC16D9A0095929P-128 ,   0xF1C90080BAF73P-125 ,   0x12E3B40A0E9B5P-118 ,   0x5E72843249089P-117 ,
     0x1D83C94FB6D2ADP-116 ,   0x49C97747490EBP-110 ,  0x170EF54646D497P-109 ,  0x1CD2B297D889BDP-106 ,   0x901D7CF73AB0BP-101 ,    0x5A126E1A84AE7P-97 ,    0xE12E13424BB41P-95 ,    0x8CBCCC096F509P-91 ,
       0xAFEBFF0BCB24BP-88 ,   0x1B7CDFD9D7BDBBP-86 ,   0x112E0BE826D695P-82 ,    0xABCC77118461DP-78 ,   0x1AD7F29ABCAF49P-76 ,    0x8637BD05AF6C7P-71 ,   0x14F8B588E368F1P-69 ,   0x1A36E2EB1C432DP-66 ,
       0x4189374BC6A7FP-60 ,   0x147AE147AE147BP-59 ,    0xCCCCCCCCCCCCDP-55 ,                  0x1P0 ,                  0x5P1 ,                 0x19P2 ,                 0x7DP3 ,                0x271P4 ,
                   0xC35P5 ,               0x3D09P6 ,              0x1312DP7 ,              0x5F5E1P8 ,             0x1DCD65P9 ,            0x9502F9P10 ,           0x2E90EDDP11 ,           0xE8D4A51P12 ,
             0x48C27395P13 ,         0x16BCC41E9P14 ,         0x71AFD498DP15 ,        0x2386F26FC1P16 ,        0xB1A2BC2EC5P17 ,       0x3782DACE9D9P18 ,      0x1158E460913DP19 ,      0x56BC75E2D631P20 ,
        0x1B1AE4D6E2EF5P21 ,     0x878678326EAC9P22 ,    0x152D02C7E14AF7P24 ,    0x1A784379D99DB5P27 ,    0x108B2A2C280291P31 ,    0x14ADF4B7320335P34 ,     0xCECB8F27F4201P38 ,     0x813F3978F8941P42 ,
        0xA18F07D736B91P45 ,     0xC9F2C9CD04675P48 ,    0x1F8DEF8808B025P50 ,    0x13B8B5B5056E17P54 ,    0x18A6E32246C99DP57 ,     0x7B426FAB61F01P62 ,    0x13426172C74D83P64 ,    0x1812F9CF7920E3P67 ,
        0x785EE10D5DA47P72 ,     0x96769950B50D9P75 ,     0xBC143FA4E250FP78 ,    0x1D6329F1C35CA5P80 ,    0x125DFA371A19E7P84 ,    0x16F578C4E0A061P87 ,    0x1CB2D6F618C879P90 ,     0x47BF19673DF53P96 ,
       0x166BB7F0435C9FP97 ,   0x1C06A5EC5433C7P100 ,    0x46109ECED2817P106 ,   0x15E531A0A1C873P107 ,    0x1B5E7E08CA3A9P114 ,    0x88D8762BF324DP115 ,   0x1561D276DDFDC1P117 ,   0x1ABA4714957D31P120 ,
      0x10B46C6CDD6E3FP124 ,    0xA70C3C40A64E7P128 ,   0x1A19E96A19FC41P130 ,   0x105031E2503DA9P134 ,   0x14643E5AE44D13P137 ,    0x32FA9BE33AC0BP143 ,    0xFEE50B7025C37P144 ,   0x13E9E4E4C2F345P147 ,
       0xC722F0EF9D80BP151 ,   0x1F1D75A5709C1BP153 ,   0x13726987666191P157 ,   0x184F03E93FF9F5P160 ,   0x1E62C4E38FF873P163 ,    0x25FB761C73F69P170 ,    0xBDE94E8E43D0DP171 ,     0xED63A231D4C5P178 ,
       0x4A2F22AF927D9P179 ,   0x172EBAD6DDC73DP180 ,    0x73E9A63254E43P185 ,    0x243903EFBA875P190 ,    0xB51D13AEA4A49P191 ,    0xE264589A4DCDBP194 ,    0x8D7EB76070A09P198 ,    0xB0DE65388CC8BP201 ,
       0x6E8AFF4357FD7P205 ,   0x1145B7E285BF99P207 ,     0x2B2E4BB64E5FP217 ,   0x1AFCEF51F0FB5FP213 ,    0x4378564CDA747P219 ,   0x15159AF8044463P220 ,   0x1A5B01B605557BP223 ,   0x1078E111C3556DP227 ,
       0x292E32AC68559P233 ,    0xCDE6FD5E09ABDP234 ,   0x10160BCB58C16DP237 ,    0x28371D7C5DE39P243 ,    0xC913936DD571DP244 ,    0x3ED61E1252B39P249 ,   0x13A2E965B9D81DP250 ,    0x622E8EFCA1389P255 ,
      0x1EAE8CAEF261ADP256 ,    0x4CB45FB55DF43P262 ,   0x17F85DE8AD5C4FP263 ,   0x1DF67562D8B363P266 ,    0x95D04AEE3B80FP271 ,    0xBB445DA9CA613P274 ,   0x1D42AEA2879F2FP276 ,   0x1249AD2594C37DP280 ,
      0x16DC186EF9F45DP283 ,    0x724C7A2AE1C5DP288 ,    0x23B7E62D668DDP293 ,    0xB2977EE300C51P294 ,   0x1BE7ABD3781ECBP296 ,   0x1170CB642B133FP300 ,   0x15CCFE3D35D80FP303 ,    0xDA01EE641A709P307 ,
       0x44209A7F48433P312 ,    0xAA51823E34A7FP314 ,    0xD4E5E2CDC1D1FP317 ,   0x10A1F5B8132467P320 ,     0x2994E64C2FDBP330 ,     0xCFE87F7CEF47P331 ,    0x40F8A7D70AC63P332 ,   0x144DB473335DEFP333 ,
      0x1961219000356BP336 ,    0xFDCB4FA002163P340 ,    0x4F4F88E200A6FP345 ,   0x18C8DAC6A0342BP346 ,   0x1EFB1178484135P349 ,   0x135CEAEB2D28C1P353 ,    0xC1A12D2FC3979P357 ,    0xF209787BB47D7P360 ,
      0x12E8BD69AA19CDP363 ,     0x5E8BB3105281P372 ,    0x1D8BA7F519C85P373 ,    0x93BA47C980E99P374 ,   0x17151B377C247FP376 ,    0xE6D3102AD96CFP380 ,   0x12087D4358FC83P383 ,    0x5A2A7250BCEE9P388 ,
       0x70B50EE4EC2A3P391 ,    0x233894A789CD3P396 ,    0xB01AE745B101FP397 ,   0x1B843422E3A84DP399 ,    0x1132A095CE493P407 ,    0x55FD22ED076DFP408 ,   0x1ADF1AEA12525BP409 ,   0x10CB70D24B7379P413 ,
      0x14FE4D06DE5057P416 ,   0x1A3DE04895E46DP419 ,    0x419AB0B576BB1P425 ,   0x14805738B51A75P426 ,   0x19A06D06E26113P429 ,    0x4011109135F2BP435 ,   0x1405552D60DBD7P436 ,    0x641AA9E2E44B3P441 ,
      0x1F485516E7577FP442 ,    0x138D352E5096BP450 ,   0x18708279E4BC5BP449 ,    0xF46518C2EF5B9P453 ,    0x262FCBDE75665P459 ,   0x17DDDF6B095FF1P459 ,   0x1DD55745CBB7EDP462 ,   0x12A5568B9F52F5P466 ,
       0xBA756174393D9P470 ,    0xE912B9D1478CFP473 ,   0x12357684599703P476 ,   0x16C2D4256FFCC3P479 ,    0x71CE24BB2FEFDP484 ,   0x11C835BD3F7D79P486 ,   0x163A432C8F5CD7P489 ,    0x6F234FDECCD03P494 ,
       0x22BB08F5A0011P499 ,    0xADA72CCC20055P500 ,    0x6C887BFF94035P504 ,   0x10F5535FEF2085P506 ,    0xA99541BF57453P510 ,   0x1A7F5245E5A2CFP512 ,    0x847C9B5D7C2E1P517 ,    0xA59BC234DB399P520 ,
       0xCF02B2C21207FP523 ,   0x102C35F729689FP526 ,   0x14374374F3C2C7P529 ,    0x328A28A46166FP535 ,    0xFCB2CB35E702BP536 ,    0x9DEFBF01B061BP540 ,    0x62B5D7610E3D1P544 ,    0x7B634D3951CC5P547 ,
      0x13478410F4C7EDP549 ,    0x3032CA2A63F3DP555 ,    0xF0FDF2D3F3C31P556 ,   0x12D3D6F88F0B3DP559 ,   0x1788CCB6B2CE0DP562 ,    0x1D6AFFE45F819P569 ,    0x9316FF75DD87DP570 ,    0x2DF72FD4D53A7P575 ,
       0xE5D3EF282A243P576 ,    0x47D23ABC8D2B5P581 ,   0x1671B25AEC1D89P582 ,   0x1C0E1EF1A724EBP585 ,   0x1188D357087713P589 ,    0x2BD610599529BP595 ,    0xDB2E51BFE9D07P596 ,   0x111F9E62FE4449P599 ,
      0x156785FBBDD55BP602 ,   0x1AC1677AAD4AB1P605 ,   0x10B8E0ACAC4EAFP609 ,   0x14E718D7D7625BP612 ,   0x1A20DF0DCD3AF1P615 ,   0x10548B68A044D7P619 ,   0x1469AE42C8560DP622 ,    0x198419D37A6B9P629 ,
      0x1FE52048590673P628 ,    0x27DE685A6F481P635 ,    0xC75809C42C685P636 ,   0x1F25C186A6F04DP638 ,    0x137798F428563P646 ,    0x6155FCC4C9AEFP647 ,   0x1E6ADEFD7F06ABP648 ,   0x1302CB5E6F642BP652 ,
       0xBE1BF1B059E9BP656 ,   0x1DB45DC38E0C83P658 ,    0x9485D4D1C63E9P663 ,    0xB9A74A0637CE3P666 ,    0x3A044721F1707P671 ,   0x1221563A9B7323P672 ,    0x5AA6AF25093FBP677 ,   0x1C5416BB92E3E7P678 ,
       0x11B48E353BCE7P686 ,    0x5886C70A2B083P687 ,   0x1BAA1E332D728FP688 ,    0x8A5296FFE33CDP693 ,     0x2B39CF2FF703P702 ,     0xD8210BEFD30FP703 ,    0x438A53BAF1F4BP704 ,   0x151B3A2A6B9C77P705 ,
      0x1A6208B5068395P708 ,   0x107D457124123DP712 ,    0x52725B35B45B3P717 ,   0x19C3BC80C85C7FP718 ,    0x101A55D07D39DP726 ,   0x1420EB449C8843P725 ,    0x64A498570EA95P730 ,   0x1F736F9B3494E9P731 ,
       0x9D412E0806E89P736 ,    0xC491798A08A2BP739 ,    0x7ADAEBF64565BP743 ,   0x133234DE7AD7E3P745 ,    0x5FFB085866377P750 ,   0x1DFE729B9FF153P751 ,    0x4AFC1E850FDB5P757 ,   0x176EC98994F489P758 ,
      0x1D4A7BEBFA31ABP761 ,   0x124E8D737C5F0BP765 ,    0xB7118682DBB67P769 ,   0x1C9ABD04725481P771 ,   0x11E0B622C774D1P775 ,   0x1658E3AB795205P778 ,    0xDF78E4B2BD343P782 ,    0x45D5C777DB205P787 ,
      0x15D2CE55747A19P788 ,   0x1B4781EAD1989FP791 ,    0x4432C4CB0BFD9P797 ,    0x553F75FDCEFCFP800 ,   0x1AA3D4DF50AF0BP801 ,   0x10A6650B926D67P805 ,   0x14CFFE4E7708C1P808 ,   0x1A03FDE214CAF1P811 ,
      0x10427EAD4CFED7P815 ,    0x514C796280FA3P820 ,   0x1967E5EEC84E2FP821 ,   0x1FC1DF6A7A61BBP824 ,   0x13D92BA28C7D15P828 ,    0xC67BB4597CE2DP832 ,   0x1F03542DFB8371P834 ,   0x1362149CBD3227P838 ,
       0x183A99C3EC7EBP845 ,    0x792500D39E797P846 ,    0x976E41088617DP849 ,    0x2F527452A9E77P854 ,    0xEC9C459D51853P855 ,    0x24F86AE094BCDP861 ,    0xB8DA1662E7B01P862 ,    0xE7109BFBA19C1P865 ,
      0x120D4C2FA8A031P868 ,    0xB484F9DC9641FP872 ,   0x1C34C70A777A4DP874 ,    0x11A0FC668AAC7P882 ,    0x5824EE00B55E3P883 ,   0x1B8B8A6038AD6FP884 ,    0x89B9B3E11B633P889 ,   0x1585041B2C477FP891 ,
      0x1AE64521F7595FP894 ,   0x10CFEB353A97DBP898 ,    0xA81F301449EE9P902 ,    0xD226FC195C6A3P905 ,    0x41AC2EC7ECE13P910 ,   0x1485CE9E7A065FP911 ,   0x19A742461887F7P914 ,    0x80444B5E7AA7DP919 ,
      0x140AABC6C32A39P921 ,   0x190D56B873F4C7P924 ,   0x1F50AC6690F1F9P927 ,    0x4E49AF006A5CFP933 ,    0xC3B8358109E85P935 ,   0x1E94C85C298C4DP937 ,    0x131CFD3999F7BP945 ,    0x5F90F22001D67P946 ,
      0x1DDD4BAA009303P947 ,    0x95527A5202DF1P952 ,    0xBAA718E68396DP955 ,   0x1D2A1BE4048F91P957 ,   0x123A516E82D9BBP961 ,   0x16C8E5CA239029P964 ,    0x71EC7CF2B1D0DP969 ,     0x8E679C2F5E45P976
   };

  return Table[dec_exp-MinDecExp];
 }

int DoubleTo10Based::DecExp(int bin_exp)
 {
  static const int Table[MaxBinExp-MinBinExp+1]= // [2098]
   {
    -323 , -323 , -322 , -322 , -322 , -321 , -321 , -321 , -320 , -320 , -320 , -319 , -319 , -319 , -319 , -318 , -318 , -318 , -317 , -317 ,
    -317 , -316 , -316 , -316 , -316 , -315 , -315 , -315 , -314 , -314 , -314 , -313 , -313 , -313 , -313 , -312 , -312 , -312 , -311 , -311 ,
    -311 , -310 , -310 , -310 , -310 , -309 , -309 , -309 , -308 , -308 , -308 , -307 , -307 , -307 , -307 , -306 , -306 , -306 , -305 , -305 ,
    -305 , -304 , -304 , -304 , -304 , -303 , -303 , -303 , -302 , -302 , -302 , -301 , -301 , -301 , -301 , -300 , -300 , -300 , -299 , -299 ,
    -299 , -298 , -298 , -298 , -298 , -297 , -297 , -297 , -296 , -296 , -296 , -295 , -295 , -295 , -295 , -294 , -294 , -294 , -293 , -293 ,
    -293 , -292 , -292 , -292 , -291 , -291 , -291 , -291 , -290 , -290 , -290 , -289 , -289 , -289 , -288 , -288 , -288 , -288 , -287 , -287 ,
    -287 , -286 , -286 , -286 , -285 , -285 , -285 , -285 , -284 , -284 , -284 , -283 , -283 , -283 , -282 , -282 , -282 , -282 , -281 , -281 ,
    -281 , -280 , -280 , -280 , -279 , -279 , -279 , -279 , -278 , -278 , -278 , -277 , -277 , -277 , -276 , -276 , -276 , -276 , -275 , -275 ,
    -275 , -274 , -274 , -274 , -273 , -273 , -273 , -273 , -272 , -272 , -272 , -271 , -271 , -271 , -270 , -270 , -270 , -270 , -269 , -269 ,
    -269 , -268 , -268 , -268 , -267 , -267 , -267 , -267 , -266 , -266 , -266 , -265 , -265 , -265 , -264 , -264 , -264 , -264 , -263 , -263 ,
    -263 , -262 , -262 , -262 , -261 , -261 , -261 , -260 , -260 , -260 , -260 , -259 , -259 , -259 , -258 , -258 , -258 , -257 , -257 , -257 ,
    -257 , -256 , -256 , -256 , -255 , -255 , -255 , -254 , -254 , -254 , -254 , -253 , -253 , -253 , -252 , -252 , -252 , -251 , -251 , -251 ,
    -251 , -250 , -250 , -250 , -249 , -249 , -249 , -248 , -248 , -248 , -248 , -247 , -247 , -247 , -246 , -246 , -246 , -245 , -245 , -245 ,
    -245 , -244 , -244 , -244 , -243 , -243 , -243 , -242 , -242 , -242 , -242 , -241 , -241 , -241 , -240 , -240 , -240 , -239 , -239 , -239 ,
    -239 , -238 , -238 , -238 , -237 , -237 , -237 , -236 , -236 , -236 , -236 , -235 , -235 , -235 , -234 , -234 , -234 , -233 , -233 , -233 ,
    -232 , -232 , -232 , -232 , -231 , -231 , -231 , -230 , -230 , -230 , -229 , -229 , -229 , -229 , -228 , -228 , -228 , -227 , -227 , -227 ,
    -226 , -226 , -226 , -226 , -225 , -225 , -225 , -224 , -224 , -224 , -223 , -223 , -223 , -223 , -222 , -222 , -222 , -221 , -221 , -221 ,
    -220 , -220 , -220 , -220 , -219 , -219 , -219 , -218 , -218 , -218 , -217 , -217 , -217 , -217 , -216 , -216 , -216 , -215 , -215 , -215 ,
    -214 , -214 , -214 , -214 , -213 , -213 , -213 , -212 , -212 , -212 , -211 , -211 , -211 , -211 , -210 , -210 , -210 , -209 , -209 , -209 ,
    -208 , -208 , -208 , -208 , -207 , -207 , -207 , -206 , -206 , -206 , -205 , -205 , -205 , -205 , -204 , -204 , -204 , -203 , -203 , -203 ,
    -202 , -202 , -202 , -201 , -201 , -201 , -201 , -200 , -200 , -200 , -199 , -199 , -199 , -198 , -198 , -198 , -198 , -197 , -197 , -197 ,
    -196 , -196 , -196 , -195 , -195 , -195 , -195 , -194 , -194 , -194 , -193 , -193 , -193 , -192 , -192 , -192 , -192 , -191 , -191 , -191 ,
    -190 , -190 , -190 , -189 , -189 , -189 , -189 , -188 , -188 , -188 , -187 , -187 , -187 , -186 , -186 , -186 , -186 , -185 , -185 , -185 ,
    -184 , -184 , -184 , -183 , -183 , -183 , -183 , -182 , -182 , -182 , -181 , -181 , -181 , -180 , -180 , -180 , -180 , -179 , -179 , -179 ,
    -178 , -178 , -178 , -177 , -177 , -177 , -177 , -176 , -176 , -176 , -175 , -175 , -175 , -174 , -174 , -174 , -173 , -173 , -173 , -173 ,
    -172 , -172 , -172 , -171 , -171 , -171 , -170 , -170 , -170 , -170 , -169 , -169 , -169 , -168 , -168 , -168 , -167 , -167 , -167 , -167 ,
    -166 , -166 , -166 , -165 , -165 , -165 , -164 , -164 , -164 , -164 , -163 , -163 , -163 , -162 , -162 , -162 , -161 , -161 , -161 , -161 ,
    -160 , -160 , -160 , -159 , -159 , -159 , -158 , -158 , -158 , -158 , -157 , -157 , -157 , -156 , -156 , -156 , -155 , -155 , -155 , -155 ,
    -154 , -154 , -154 , -153 , -153 , -153 , -152 , -152 , -152 , -152 , -151 , -151 , -151 , -150 , -150 , -150 , -149 , -149 , -149 , -149 ,
    -148 , -148 , -148 , -147 , -147 , -147 , -146 , -146 , -146 , -145 , -145 , -145 , -145 , -144 , -144 , -144 , -143 , -143 , -143 , -142 ,
    -142 , -142 , -142 , -141 , -141 , -141 , -140 , -140 , -140 , -139 , -139 , -139 , -139 , -138 , -138 , -138 , -137 , -137 , -137 , -136 ,
    -136 , -136 , -136 , -135 , -135 , -135 , -134 , -134 , -134 , -133 , -133 , -133 , -133 , -132 , -132 , -132 , -131 , -131 , -131 , -130 ,
    -130 , -130 , -130 , -129 , -129 , -129 , -128 , -128 , -128 , -127 , -127 , -127 , -127 , -126 , -126 , -126 , -125 , -125 , -125 , -124 ,
    -124 , -124 , -124 , -123 , -123 , -123 , -122 , -122 , -122 , -121 , -121 , -121 , -121 , -120 , -120 , -120 , -119 , -119 , -119 , -118 ,
    -118 , -118 , -118 , -117 , -117 , -117 , -116 , -116 , -116 , -115 , -115 , -115 , -114 , -114 , -114 , -114 , -113 , -113 , -113 , -112 ,
    -112 , -112 , -111 , -111 , -111 , -111 , -110 , -110 , -110 , -109 , -109 , -109 , -108 , -108 , -108 , -108 , -107 , -107 , -107 , -106 ,
    -106 , -106 , -105 , -105 , -105 , -105 , -104 , -104 , -104 , -103 , -103 , -103 , -102 , -102 , -102 , -102 , -101 , -101 , -101 , -100 ,
    -100 , -100 ,  -99 ,  -99 ,  -99 ,  -99 ,  -98 ,  -98 ,  -98 ,  -97 ,  -97 ,  -97 ,  -96 ,  -96 ,  -96 ,  -96 ,  -95 ,  -95 ,  -95 ,  -94 ,
     -94 ,  -94 ,  -93 ,  -93 ,  -93 ,  -93 ,  -92 ,  -92 ,  -92 ,  -91 ,  -91 ,  -91 ,  -90 ,  -90 ,  -90 ,  -90 ,  -89 ,  -89 ,  -89 ,  -88 ,
     -88 ,  -88 ,  -87 ,  -87 ,  -87 ,  -86 ,  -86 ,  -86 ,  -86 ,  -85 ,  -85 ,  -85 ,  -84 ,  -84 ,  -84 ,  -83 ,  -83 ,  -83 ,  -83 ,  -82 ,
     -82 ,  -82 ,  -81 ,  -81 ,  -81 ,  -80 ,  -80 ,  -80 ,  -80 ,  -79 ,  -79 ,  -79 ,  -78 ,  -78 ,  -78 ,  -77 ,  -77 ,  -77 ,  -77 ,  -76 ,
     -76 ,  -76 ,  -75 ,  -75 ,  -75 ,  -74 ,  -74 ,  -74 ,  -74 ,  -73 ,  -73 ,  -73 ,  -72 ,  -72 ,  -72 ,  -71 ,  -71 ,  -71 ,  -71 ,  -70 ,
     -70 ,  -70 ,  -69 ,  -69 ,  -69 ,  -68 ,  -68 ,  -68 ,  -68 ,  -67 ,  -67 ,  -67 ,  -66 ,  -66 ,  -66 ,  -65 ,  -65 ,  -65 ,  -65 ,  -64 ,
     -64 ,  -64 ,  -63 ,  -63 ,  -63 ,  -62 ,  -62 ,  -62 ,  -62 ,  -61 ,  -61 ,  -61 ,  -60 ,  -60 ,  -60 ,  -59 ,  -59 ,  -59 ,  -59 ,  -58 ,
     -58 ,  -58 ,  -57 ,  -57 ,  -57 ,  -56 ,  -56 ,  -56 ,  -55 ,  -55 ,  -55 ,  -55 ,  -54 ,  -54 ,  -54 ,  -53 ,  -53 ,  -53 ,  -52 ,  -52 ,
     -52 ,  -52 ,  -51 ,  -51 ,  -51 ,  -50 ,  -50 ,  -50 ,  -49 ,  -49 ,  -49 ,  -49 ,  -48 ,  -48 ,  -48 ,  -47 ,  -47 ,  -47 ,  -46 ,  -46 ,
     -46 ,  -46 ,  -45 ,  -45 ,  -45 ,  -44 ,  -44 ,  -44 ,  -43 ,  -43 ,  -43 ,  -43 ,  -42 ,  -42 ,  -42 ,  -41 ,  -41 ,  -41 ,  -40 ,  -40 ,
     -40 ,  -40 ,  -39 ,  -39 ,  -39 ,  -38 ,  -38 ,  -38 ,  -37 ,  -37 ,  -37 ,  -37 ,  -36 ,  -36 ,  -36 ,  -35 ,  -35 ,  -35 ,  -34 ,  -34 ,
     -34 ,  -34 ,  -33 ,  -33 ,  -33 ,  -32 ,  -32 ,  -32 ,  -31 ,  -31 ,  -31 ,  -31 ,  -30 ,  -30 ,  -30 ,  -29 ,  -29 ,  -29 ,  -28 ,  -28 ,
     -28 ,  -27 ,  -27 ,  -27 ,  -27 ,  -26 ,  -26 ,  -26 ,  -25 ,  -25 ,  -25 ,  -24 ,  -24 ,  -24 ,  -24 ,  -23 ,  -23 ,  -23 ,  -22 ,  -22 ,
     -22 ,  -21 ,  -21 ,  -21 ,  -21 ,  -20 ,  -20 ,  -20 ,  -19 ,  -19 ,  -19 ,  -18 ,  -18 ,  -18 ,  -18 ,  -17 ,  -17 ,  -17 ,  -16 ,  -16 ,
     -16 ,  -15 ,  -15 ,  -15 ,  -15 ,  -14 ,  -14 ,  -14 ,  -13 ,  -13 ,  -13 ,  -12 ,  -12 ,  -12 ,  -12 ,  -11 ,  -11 ,  -11 ,  -10 ,  -10 ,
     -10 ,   -9 ,   -9 ,   -9 ,   -9 ,   -8 ,   -8 ,   -8 ,   -7 ,   -7 ,   -7 ,   -6 ,   -6 ,   -6 ,   -6 ,   -5 ,   -5 ,   -5 ,   -4 ,   -4 ,
      -4 ,   -3 ,   -3 ,   -3 ,   -3 ,   -2 ,   -2 ,   -2 ,   -1 ,   -1 ,   -1 ,    0 ,    0 ,    0 ,    1 ,    1 ,    1 ,    1 ,    2 ,    2 ,
       2 ,    3 ,    3 ,    3 ,    4 ,    4 ,    4 ,    4 ,    5 ,    5 ,    5 ,    6 ,    6 ,    6 ,    7 ,    7 ,    7 ,    7 ,    8 ,    8 ,
       8 ,    9 ,    9 ,    9 ,   10 ,   10 ,   10 ,   10 ,   11 ,   11 ,   11 ,   12 ,   12 ,   12 ,   13 ,   13 ,   13 ,   13 ,   14 ,   14 ,
      14 ,   15 ,   15 ,   15 ,   16 ,   16 ,   16 ,   16 ,   17 ,   17 ,   17 ,   18 ,   18 ,   18 ,   19 ,   19 ,   19 ,   19 ,   20 ,   20 ,
      20 ,   21 ,   21 ,   21 ,   22 ,   22 ,   22 ,   22 ,   23 ,   23 ,   23 ,   24 ,   24 ,   24 ,   25 ,   25 ,   25 ,   25 ,   26 ,   26 ,
      26 ,   27 ,   27 ,   27 ,   28 ,   28 ,   28 ,   28 ,   29 ,   29 ,   29 ,   30 ,   30 ,   30 ,   31 ,   31 ,   31 ,   32 ,   32 ,   32 ,
      32 ,   33 ,   33 ,   33 ,   34 ,   34 ,   34 ,   35 ,   35 ,   35 ,   35 ,   36 ,   36 ,   36 ,   37 ,   37 ,   37 ,   38 ,   38 ,   38 ,
      38 ,   39 ,   39 ,   39 ,   40 ,   40 ,   40 ,   41 ,   41 ,   41 ,   41 ,   42 ,   42 ,   42 ,   43 ,   43 ,   43 ,   44 ,   44 ,   44 ,
      44 ,   45 ,   45 ,   45 ,   46 ,   46 ,   46 ,   47 ,   47 ,   47 ,   47 ,   48 ,   48 ,   48 ,   49 ,   49 ,   49 ,   50 ,   50 ,   50 ,
      50 ,   51 ,   51 ,   51 ,   52 ,   52 ,   52 ,   53 ,   53 ,   53 ,   53 ,   54 ,   54 ,   54 ,   55 ,   55 ,   55 ,   56 ,   56 ,   56 ,
      56 ,   57 ,   57 ,   57 ,   58 ,   58 ,   58 ,   59 ,   59 ,   59 ,   60 ,   60 ,   60 ,   60 ,   61 ,   61 ,   61 ,   62 ,   62 ,   62 ,
      63 ,   63 ,   63 ,   63 ,   64 ,   64 ,   64 ,   65 ,   65 ,   65 ,   66 ,   66 ,   66 ,   66 ,   67 ,   67 ,   67 ,   68 ,   68 ,   68 ,
      69 ,   69 ,   69 ,   69 ,   70 ,   70 ,   70 ,   71 ,   71 ,   71 ,   72 ,   72 ,   72 ,   72 ,   73 ,   73 ,   73 ,   74 ,   74 ,   74 ,
      75 ,   75 ,   75 ,   75 ,   76 ,   76 ,   76 ,   77 ,   77 ,   77 ,   78 ,   78 ,   78 ,   78 ,   79 ,   79 ,   79 ,   80 ,   80 ,   80 ,
      81 ,   81 ,   81 ,   81 ,   82 ,   82 ,   82 ,   83 ,   83 ,   83 ,   84 ,   84 ,   84 ,   84 ,   85 ,   85 ,   85 ,   86 ,   86 ,   86 ,
      87 ,   87 ,   87 ,   87 ,   88 ,   88 ,   88 ,   89 ,   89 ,   89 ,   90 ,   90 ,   90 ,   91 ,   91 ,   91 ,   91 ,   92 ,   92 ,   92 ,
      93 ,   93 ,   93 ,   94 ,   94 ,   94 ,   94 ,   95 ,   95 ,   95 ,   96 ,   96 ,   96 ,   97 ,   97 ,   97 ,   97 ,   98 ,   98 ,   98 ,
      99 ,   99 ,   99 ,  100 ,  100 ,  100 ,  100 ,  101 ,  101 ,  101 ,  102 ,  102 ,  102 ,  103 ,  103 ,  103 ,  103 ,  104 ,  104 ,  104 ,
     105 ,  105 ,  105 ,  106 ,  106 ,  106 ,  106 ,  107 ,  107 ,  107 ,  108 ,  108 ,  108 ,  109 ,  109 ,  109 ,  109 ,  110 ,  110 ,  110 ,
     111 ,  111 ,  111 ,  112 ,  112 ,  112 ,  112 ,  113 ,  113 ,  113 ,  114 ,  114 ,  114 ,  115 ,  115 ,  115 ,  115 ,  116 ,  116 ,  116 ,
     117 ,  117 ,  117 ,  118 ,  118 ,  118 ,  119 ,  119 ,  119 ,  119 ,  120 ,  120 ,  120 ,  121 ,  121 ,  121 ,  122 ,  122 ,  122 ,  122 ,
     123 ,  123 ,  123 ,  124 ,  124 ,  124 ,  125 ,  125 ,  125 ,  125 ,  126 ,  126 ,  126 ,  127 ,  127 ,  127 ,  128 ,  128 ,  128 ,  128 ,
     129 ,  129 ,  129 ,  130 ,  130 ,  130 ,  131 ,  131 ,  131 ,  131 ,  132 ,  132 ,  132 ,  133 ,  133 ,  133 ,  134 ,  134 ,  134 ,  134 ,
     135 ,  135 ,  135 ,  136 ,  136 ,  136 ,  137 ,  137 ,  137 ,  137 ,  138 ,  138 ,  138 ,  139 ,  139 ,  139 ,  140 ,  140 ,  140 ,  140 ,
     141 ,  141 ,  141 ,  142 ,  142 ,  142 ,  143 ,  143 ,  143 ,  143 ,  144 ,  144 ,  144 ,  145 ,  145 ,  145 ,  146 ,  146 ,  146 ,  146 ,
     147 ,  147 ,  147 ,  148 ,  148 ,  148 ,  149 ,  149 ,  149 ,  150 ,  150 ,  150 ,  150 ,  151 ,  151 ,  151 ,  152 ,  152 ,  152 ,  153 ,
     153 ,  153 ,  153 ,  154 ,  154 ,  154 ,  155 ,  155 ,  155 ,  156 ,  156 ,  156 ,  156 ,  157 ,  157 ,  157 ,  158 ,  158 ,  158 ,  159 ,
     159 ,  159 ,  159 ,  160 ,  160 ,  160 ,  161 ,  161 ,  161 ,  162 ,  162 ,  162 ,  162 ,  163 ,  163 ,  163 ,  164 ,  164 ,  164 ,  165 ,
     165 ,  165 ,  165 ,  166 ,  166 ,  166 ,  167 ,  167 ,  167 ,  168 ,  168 ,  168 ,  168 ,  169 ,  169 ,  169 ,  170 ,  170 ,  170 ,  171 ,
     171 ,  171 ,  171 ,  172 ,  172 ,  172 ,  173 ,  173 ,  173 ,  174 ,  174 ,  174 ,  174 ,  175 ,  175 ,  175 ,  176 ,  176 ,  176 ,  177 ,
     177 ,  177 ,  178 ,  178 ,  178 ,  178 ,  179 ,  179 ,  179 ,  180 ,  180 ,  180 ,  181 ,  181 ,  181 ,  181 ,  182 ,  182 ,  182 ,  183 ,
     183 ,  183 ,  184 ,  184 ,  184 ,  184 ,  185 ,  185 ,  185 ,  186 ,  186 ,  186 ,  187 ,  187 ,  187 ,  187 ,  188 ,  188 ,  188 ,  189 ,
     189 ,  189 ,  190 ,  190 ,  190 ,  190 ,  191 ,  191 ,  191 ,  192 ,  192 ,  192 ,  193 ,  193 ,  193 ,  193 ,  194 ,  194 ,  194 ,  195 ,
     195 ,  195 ,  196 ,  196 ,  196 ,  196 ,  197 ,  197 ,  197 ,  198 ,  198 ,  198 ,  199 ,  199 ,  199 ,  199 ,  200 ,  200 ,  200 ,  201 ,
     201 ,  201 ,  202 ,  202 ,  202 ,  202 ,  203 ,  203 ,  203 ,  204 ,  204 ,  204 ,  205 ,  205 ,  205 ,  206 ,  206 ,  206 ,  206 ,  207 ,
     207 ,  207 ,  208 ,  208 ,  208 ,  209 ,  209 ,  209 ,  209 ,  210 ,  210 ,  210 ,  211 ,  211 ,  211 ,  212 ,  212 ,  212 ,  212 ,  213 ,
     213 ,  213 ,  214 ,  214 ,  214 ,  215 ,  215 ,  215 ,  215 ,  216 ,  216 ,  216 ,  217 ,  217 ,  217 ,  218 ,  218 ,  218 ,  218 ,  219 ,
     219 ,  219 ,  220 ,  220 ,  220 ,  221 ,  221 ,  221 ,  221 ,  222 ,  222 ,  222 ,  223 ,  223 ,  223 ,  224 ,  224 ,  224 ,  224 ,  225 ,
     225 ,  225 ,  226 ,  226 ,  226 ,  227 ,  227 ,  227 ,  227 ,  228 ,  228 ,  228 ,  229 ,  229 ,  229 ,  230 ,  230 ,  230 ,  230 ,  231 ,
     231 ,  231 ,  232 ,  232 ,  232 ,  233 ,  233 ,  233 ,  233 ,  234 ,  234 ,  234 ,  235 ,  235 ,  235 ,  236 ,  236 ,  236 ,  237 ,  237 ,
     237 ,  237 ,  238 ,  238 ,  238 ,  239 ,  239 ,  239 ,  240 ,  240 ,  240 ,  240 ,  241 ,  241 ,  241 ,  242 ,  242 ,  242 ,  243 ,  243 ,
     243 ,  243 ,  244 ,  244 ,  244 ,  245 ,  245 ,  245 ,  246 ,  246 ,  246 ,  246 ,  247 ,  247 ,  247 ,  248 ,  248 ,  248 ,  249 ,  249 ,
     249 ,  249 ,  250 ,  250 ,  250 ,  251 ,  251 ,  251 ,  252 ,  252 ,  252 ,  252 ,  253 ,  253 ,  253 ,  254 ,  254 ,  254 ,  255 ,  255 ,
     255 ,  255 ,  256 ,  256 ,  256 ,  257 ,  257 ,  257 ,  258 ,  258 ,  258 ,  258 ,  259 ,  259 ,  259 ,  260 ,  260 ,  260 ,  261 ,  261 ,
     261 ,  261 ,  262 ,  262 ,  262 ,  263 ,  263 ,  263 ,  264 ,  264 ,  264 ,  265 ,  265 ,  265 ,  265 ,  266 ,  266 ,  266 ,  267 ,  267 ,
     267 ,  268 ,  268 ,  268 ,  268 ,  269 ,  269 ,  269 ,  270 ,  270 ,  270 ,  271 ,  271 ,  271 ,  271 ,  272 ,  272 ,  272 ,  273 ,  273 ,
     273 ,  274 ,  274 ,  274 ,  274 ,  275 ,  275 ,  275 ,  276 ,  276 ,  276 ,  277 ,  277 ,  277 ,  277 ,  278 ,  278 ,  278 ,  279 ,  279 ,
     279 ,  280 ,  280 ,  280 ,  280 ,  281 ,  281 ,  281 ,  282 ,  282 ,  282 ,  283 ,  283 ,  283 ,  283 ,  284 ,  284 ,  284 ,  285 ,  285 ,
     285 ,  286 ,  286 ,  286 ,  286 ,  287 ,  287 ,  287 ,  288 ,  288 ,  288 ,  289 ,  289 ,  289 ,  289 ,  290 ,  290 ,  290 ,  291 ,  291 ,
     291 ,  292 ,  292 ,  292 ,  292 ,  293 ,  293 ,  293 ,  294 ,  294 ,  294 ,  295 ,  295 ,  295 ,  296 ,  296 ,  296 ,  296 ,  297 ,  297 ,
     297 ,  298 ,  298 ,  298 ,  299 ,  299 ,  299 ,  299 ,  300 ,  300 ,  300 ,  301 ,  301 ,  301 ,  302 ,  302 ,  302 ,  302 ,  303 ,  303 ,
     303 ,  304 ,  304 ,  304 ,  305 ,  305 ,  305 ,  305 ,  306 ,  306 ,  306 ,  307 ,  307 ,  307 ,  308 ,  308 ,  308 ,  308
   };

  return Table[bin_exp-MinBinExp];
 }

int DoubleTo10Based::DecExp(double value,int bin_exp)
 {
  int ret=DecExp(bin_exp);

  if( value<Pow10hi(ret) ) return ret;

  return ret+1;
 }

void DoubleTo10Based::complete(double value,unsigned digit_len_,int bin_exp)
 {
  int digit_len=Cap<unsigned>(MinDigitLen,digit_len_,MaxDigitLen);

  dec_exp=DecExp(value,bin_exp)-digit_len;

  int e=-dec_exp;

  if( e<=MaxDecExp )
    {
     value=std::round( value*Pow10lo(e) );
    }
  else
    {
     value=std::round( value*Pow10lo(MaxDecExp)*Pow10lo(e-MaxDecExp) );
    }

  base=static_cast<BaseType>(value);
 }

DoubleTo10Based::DoubleTo10Based(double value,unsigned digit_len)
 {
  DoubleFormat obj(value);

  unsigned exp=obj.getExp();

  if( exp==DoubleFormat::MaxExp )
    {
     if( obj.getFract() )
       {
        kind=DoubleIsNan;
       }
     else
       {
        kind=DoubleIsInf;
       }
    }
  else if( exp )
    {
     if( obj.getSign() )
       {
        kind=DoubleIsNeg;
        value=-value;
       }
     else
       {
        kind=DoubleIsPos;
       }

     int bin_exp=int(exp)-int(DoubleFormat::ExpBias);

     complete(value,digit_len,bin_exp);
    }
  else
    {
     base=obj.getFract();

     if( base )
       {
        if( obj.getSign() )
          {
           kind=DoubleIsNeg;
           value=-value;
          }
        else
          {
           kind=DoubleIsPos;
          }

        int bits=UIntBitsOf(base);
        int bin_exp=bits-DExp;

        complete(value,digit_len,bin_exp);
       }
     else
       {
        kind=DoubleIsNull;
       }
    }
 }

/* class DoubleToDec */

DoubleToDec::DoubleToDec(double value,unsigned digit_len)
 {
  DoubleTo10Based obj(value,digit_len);

  kind=obj.kind;

  if( kind==DoubleIsPos || kind==DoubleIsNeg )
    {
     dec_exp=obj.dec_exp;

     base.do_uint(obj.base);
    }
 }

ulen DoubleToDec::getDecLen(IntShowSign show_sign) const
 {
  PrintCount<void> out;

  printDec(out,show_sign);

  return out.getCount();
 }

ulen DoubleToDec::getExpLen(IntShowSign show_sign) const
 {
  PrintCount<void> out;

  printExp(out,show_sign);

  return out.getCount();
 }

/* class DoubleToHex */

DoubleToHex::DoubleToHex(double value)
 : base(16)
 {
  DoubleTo2Based obj(value);

  kind=obj.kind;

  if( kind==DoubleIsPos || kind==DoubleIsNeg )
    {
     bin_exp=obj.bin_exp;

     base.do_uint(obj.base);
    }
 }

ulen DoubleToHex::getLen() const
 {
  PrintCount<void> out;

  print(out);

  return out.getCount();
 }

/* struct DoublePrintOpt */

DoublePrintOpt::DoublePrintOpt(const char *ptr,const char *lim)
 {
  StrParse dev(ptr,lim);

  Parse_empty(dev,show_sign);

  ParseUInt_empty(dev,width,0u);

  Parse_empty(dev,fmt);

  switch( Parse_DoubleLenPrefix(dev) )
    {
     case DoubleDigitLen :
      {
       ParseUInt(dev,digit_len);

       switch( Parse_DoubleLenPrefix(dev) )
         {
          case DoubleDigitLen :
           {
            dev.fail();
           }
          break;

          case DoubleExpLen :
           {
            ParseUInt(dev,exp_len);
           }
          break;

          default:
           {
            exp_len=DefaultExpLen;
           }
         }
      }
     break;

     case DoubleExpLen :
      {
       digit_len=DefaultDigitLen;

       ParseUInt(dev,exp_len);
      }
     break;

     default:
      {
       digit_len=DefaultDigitLen;
       exp_len=DefaultExpLen;
      }
    }

  Parse_empty(dev,align);

  if( !dev.finish() ) setDefault();
 }

} // namespace CCore

#endif
